html <!DOCTYPE>
<!-- loosely based on https://raw.github.com/acruikshank/c5-d3-lunch-talk/master/solar-system3.html -->
<html>
  <head>
    <title>Space view</title>
    <script type="text/javascript" src="jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="d3.v2.min.js"></script>
    <style type="text/css">
      body { background: black; margin: 0; padding: 0 }
      svg { width: 1200px; height: 600px; margin:0 auto}
      .step { background: green; }
      #view { position: relative; }
      #detail-view { position: absolute; width: 400px; background: white; color: black; top: 4px; right: 4px; z-index: 100; padding: 6px;}
      #detail-view img { width: 100%; }
      #detail-view p { color: black; font-size: 20px; margin: 0; padding: 0 }

      #header { position: absolute; color: #fff; width: 100%; text-align: center }
      h1 { font-size: 30px; padding: 0; margin: 0; }
      h2 { font-size: 18px; padding: 0; margin: 0; }
    </style>
  </head>
  <body>

    <div id="header">
      <h1>Space view</h1>
      <h2 style="color: green">Voyager 1</h2>
    </div>

    <div id="view">
      <div id="detail-view">
        <img src="http://pds-rings.seti.org/volumes/VGISS_6xxx/VGISS_6109/BROWSE/C34512XX/C3451210_GEOMED.JPG" />
        <p>Voyager, <span id="clicked-date">YEAR-MM-DD</span></p>
      </div>
    </div>
    <script type="text/javascript">

  var objects = [
    { name:'Mercury', distance:0.3871 },
    { name:'Venus', distance:0.7233 },
    { name:'Earth', distance:1, color: 'green' },
    { name:'Mars', distance:1.5237, color: 'red' },
    { name:'Jupiter', distance:5.2028 },
    { name:'Saturn', distance:9.5550 },
    { name:'Uranus', distance:19.1914 },
    { name:'Neptune', distance:30.1094 },
  ]

  var SCALE = 8;
  function orbit(d) { return d.distance * SCALE; }
  function color(d) { return d.color ? d.color : '#aaa'; }

  var vis = d3.select("#view").append("svg").append('g').attr('transform','translate(300,300) rotate(-90)');

  var orbits = vis.selectAll('ellipse.orbit').data(objects, function(d) { return d.name; });
  orbits
    .enter().append('ellipse').attr('cx',0).attr('cy',0).attr('rx',orbit).attr('ry',orbit)
            .attr('fill', 'none').attr('opacity',1).attr('stroke-width', 1).attr('stroke',color).classed('orbit',true);

  var path = [];
  var current_step_idx = null;

  function update_preview() {
    $("#detail-view").fadeOut(50);
    if (current_step_idx != null) {
      var step = path[current_step_idx];
      $("#clicked-date").html(step[0]);
      $("#detail-view").fadeIn(50);
    }
  }

  update_preview();

  $.getJSON('./voyager.json', function(data) {
    path = data;

    var path_points = vis.selectAll('ellipse.step').data(path, function(p) { return p[0]; });
    path_points
      .enter().append('ellipse')
        .attr('cx', function(p) { return p[1] * SCALE; }).attr('cy', function(p) { return -p[2] * SCALE; }).attr('rx', 3).attr('ry', 3)
        .attr('fill', 'green').attr('stroke', 'green')
        .attr('opacity', 1).classed('step', true)
        .on("mouseover",function(d,i) { d3.select(this).attr("fill","red"); }) 
        .on("mouseout",function(d,i) { d3.select(this).attr("fill","green"); })
        .on("click",function(d,i) { current_step_idx = i; update_preview(); })
        .append('svg:title').text(function(p) { return p[0] + ": " + p[1] + "," + p[2];})
        ;
  })
  .fail(function(jqXHR, textStatus, errorThrown) { alert("error" +  textStatus + " " + errorThrown); });

  function change_current(direction) {
    if (current_step_idx == null) {
      if (direction == -1) {
        current_step_idx = path.length - 1;
      } else {
        current_step_idx = 0;
      }
    } else {
      current_step_idx = Math.min(path.length - 1, Math.max(0, current_step_idx + direction));
      update_preview();
    }
  }

  $(document).keydown(function(e){
      if (e.keyCode == 37) { 
         change_current(-1);
         return false;
      }
      if (e.keyCode == 39) { 
         change_current(1);
         return false;
      }
  });

    </script>
  </body>
</html>
